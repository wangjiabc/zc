<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta content="" name="description"/>
    <meta content="webthemez" name="author"/>
    <title>中财财务</title>
    <script src="assets/js/jquery-3.2.1.min.js"></script>
    <link rel="stylesheet"
          href="assets/bootstrap-table/bootstrap-table.css">
    <link rel="stylesheet"
          href="assets/bootstrap-table/bootstrap-editable.css">
    <script src="assets/bootstrap-table/jquery.min.js"></script>
    <link rel="stylesheet" href="assets/bootstrap-table/bootstrap.min.css">
    <script src="assets/bootstrap-table/bootstrap-table.js"></script>
    <script src="assets/bootstrap-table/bootstrap-table-export.js"></script>
    <script src="assets/bootstrap-table/tableExport.js"></script>
    <script src="assets/bootstrap-table/bootstrap-table-editable.js"></script>

    <script src="js/bootstrap-table-zh-CN.min.js"></script>
    <script type="text/javascript" src="bootstrap/js/bootstrap-datetimepicker.js" charset="UTF-8"></script>
    <!-- Bootstrap Js -->
    <script src="assets/js/bootstrap.min.js"></script>
    <!-- Metis Menu Js -->
    <script src="assets/js/jquery.metisMenu.js"></script>
    <!-- Custom Js -->
    <script src="assets/js/custom-scripts.js"></script>
    <script src="assets/js/select2.full.min.js"></script>
    <!-- DATA TABLE SCRIPTS -->
    <script src="assets/js/dataTables/jquery.dataTables.js"></script>
    <script src="assets/js/dataTables/dataTables.bootstrap.js"></script>
    <script src="assets/js/form-validator/form-validator.js"></script>

    <!-- Bootstrap Styles-->
    <link href="assets/css/bootstrap.css" rel="stylesheet"/>
    <!-- FontAwesome Styles-->
    <link href="assets/css/font-awesome.css" rel="stylesheet"/>
    <link href="assets/css/checkbox3.min.css" rel="stylesheet">
    <!-- Morris Chart Styles-->

    <!-- Custom Styles-->
    <link href="assets/css/custom-styles1.css" rel="stylesheet"/>
    <!-- Google Fonts-->
    <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'/>
    <link rel="stylesheet" href="assets/js/Lightweight-Chart/cssCharts.css">

</head>
<body>
<div class="header">
    <h1 class="page-header">客户列表信息</h1>
</div>
<div id="page-inner">
    <div class="row">
        <div class="col-xs-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="card-title">
                        <div class="title">查询</div>
                    </div>
                </div>
                <div class="panel-body">
                    <form class="form-horizontal" id="userinfo-form">
                        <div class="row">
                            <div class="form-group col-sm-3">
                                <label class="col-sm-3 control-label">姓名</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="username"
                                           id="username" placeholder="填入姓名">
                                </div>
                            </div>
                            <div class="form-group col-sm-3">
                                <label class="col-sm-3 control-label">身份证</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="useridCard" id="useridCard"
                                           placeholder="填入身份证号">
                                </div>
                            </div>
                            <div class="form-group col-sm-3">
                                <label class="col-sm-3 control-label">手机号</label>
                                <div class="col-sm-9">
                                    <input type="text" class="form-control" name="userPhoneNum"
                                           id="userPhoneNum"
                                           placeholder="填入手机号">
                                </div>
                            </div>

                            <div class="form-group col-sm-3">
                                <button type="button" id="queryUser" class="btn btn-success">查询</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-xs-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    <div class="card-title">
                        <div class="title">个人信息</div>
                    </div>
                </div>
                <div class="panel-body" id="template">
                    <div class="table-responsive">
                        <div id="toolbar" class="btn-group">
                            <button id="plus" type="button" class="btn btn-default">
                                <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>新增
                            </button>                           
                            <button id="edit" type="button" class="btn btn-default">
                                <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>修改
                            </button>
                            <button id="delete" type="button" class="btn btn-default">
                                <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>删除
                            </button>
                        </div>
                        <table id="table" class="table " data-toggle="table" data-toolbar="#toolbar"
                               data-url="/zc/clientinfo/getAll.do" data-search="true"
                               data-show-refresh="true" data-show-toggle="true"
                               data-side-pagination="server" data-pagination="true"
                               data-show-columns="true" data-sort-order="desc">
                            <thead>
                            <tr>
                                <th data-field="state" data-checkbox="true"></th>
                                <th data-align="left" data-field="id" data-sortable="true">id</th>
                                <th data-align="left" data-field="userName" data-formatter="actionDetail">姓名</th>
                                <th data-align="left" data-field="userOldname" data-visible="false">曾用名</th>
                                <th data-align="left" data-field="userAge">年龄</th>
                                <th data-align="left" data-field="userSex">性别</th>
                                <th data-align="left" data-field="userEducation" data-visible="false">学历</th>
                                <th data-align="left" data-field="userMarriage" data-visible="false">婚姻状况</th>
                                <th data-align="left" data-field="useridCard">证件号</th>
                                <th data-align="left" data-field="userPhoneNum">手机号</th>
                                <th data-align="left" data-field="guid" data-formatter="actionReport">操作</th>
                                <th data-align="left" data-field="status" data-formatter="actionStatus">借款状态</th>
                                <th data-align="left" data-field="campusAdmin">录入人员</th>
                                <th data-align="left" data-field="updateTime" data-formatter="actionTime"
                                    data-visible="false">更新时间
                                </th>
                                <th data-align="left" data-field="insertTime" data-formatter="actionTime"
                                    data-sortable="true">录入时间
                                </th>
                                <th data-align="left" data-field="guid" data-sortable="true">客户ID</th>
                                <th data-align="left" data-field="remark" data-sortable="true">备注</th>
                                <th data-align="left" data-field="userProvideNum" data-visible="false">供养人数</th>
                                <th data-align="left" data-field="userChildrenNum" data-visible="false">子女数目
                                </th>
                                <th data-align="left" data-field="usercrAdress" data-visible="false">户籍地址</th>
                                <th data-align="left" data-field="userHouseState" data-visible="false">房产状况</th>
                                <th data-align="left" data-field="userNowAdress" data-visible="false">现住地址</th>
                                <th data-align="left" data-field="userTelNum" data-visible="false">固话</th>
                                <th data-align="left" data-field="userWechat" data-visible="false">微信</th>
                                <th data-align="left" data-field="userqqNum" data-visible="false">QQ</th>
                                <th data-align="left" data-field="userSocialBase" data-visible="false">
                                    社保基数/公积金基数
                                </th>
                                <th data-align="left" data-field="userCreditCard" data-visible="false">最高额度信用卡
                                </th>
                                <th data-align="left" data-field="userPhoneMonad" data-visible="false">
                                    近六个月的电话详单
                                </th>
                                <th data-align="left" data-field="userBankOpen" data-visible="false">划账银行卡开户行
                                </th>

                                <th data-align="left" data-field="insCompany" data-visible="false">投保公司</th>
                                <th data-align="left" data-field="insNum" data-visible="false">保单号码</th>
                                <th data-align="left" data-field="instime" data-visible="false">投保期限</th>
                                <th data-align="left" data-field="attatchNum" data-visible="false">附加个数</th>
                                <th data-align="left" data-field="payOntime" data-visible="false">缴费准时性</th>
                                <th data-align="left" data-field="payMode" data-visible="false">缴费方式</th>
                                <th data-align="left" data-field="insMoney" data-visible="false">年缴保费</th>
                                <th data-align="left" data-field="payTerm" data-visible="false">已缴期数</th>

                                <th data-align="left" data-field="unitName" data-visible="false">单位全称</th>
                                <th data-align="left" data-field="unitAddress" data-visible="false">单位地址</th>
                                <th data-align="left" data-field="unitPhone" data-visible="false">单位电话</th>
                                <th data-align="left" data-field="postcode" data-visible="false">邮编</th>
                                <th data-align="left" data-field="department" data-visible="false">部门</th>
                                <th data-align="left" data-field="duty" data-visible="false">职务</th>
                                <th data-align="left" data-field="workTime" data-visible="false">现单位工作年限</th>
                                <th data-align="left" data-field="industry" data-visible="false">所属行业</th>
                                <th data-align="left" data-field="unitNature" data-visible="false">单位性质</th>
                                <th data-align="left" data-field="workNature" data-visible="false">工作性质</th>
                                <th data-align="left" data-field="monthSalary" data-visible="false">月基本薪资</th>
                                <th data-align="left" data-field="salaryStyle" data-visible="false">薪资方式</th>
                                <th data-align="left" data-field="payDay" data-visible="false">月发薪日</th>
                                <th data-align="left" data-field="otherIncome " data-visible="false">其他月收入</th>

                                <th data-align="left" data-field="borrowUse" data-visible="false">借款用途</th>
                                <th data-align="left" data-field="applyMoney" data-visible="false">您希望申请的金额</th>
                                <th data-align="left" data-field="weekRepayment" data-visible="false">
                                    您可接受每周还款额
                                </th>
                                <th data-align="left" data-field="applyTime" data-visible="false">申请期限</th>

                                <th data-align="left" data-field="kinshipName" data-visible="false">亲属姓名</th>
                                <th data-align="left" data-field="kinshipRelation" data-visible="false">亲属关系
                                </th>
                                <th data-align="left" data-field="kinshipUnitName" data-visible="false">亲属单位名称
                                </th>
                                <th data-align="left" data-field="kinshipPhoneNum" data-visible="false">亲属联系电话
                                </th>
                                <th data-align="left" data-field="kinshipAddress" data-visible="false">亲属家庭住址
                                </th>

                                <th data-align="left" data-field="emergencyName" data-visible="false">紧急联系人姓名
                                </th>
                                <th data-align="left" data-field="emergencyRelation" data-visible="false">
                                    紧急联系人关系
                                </th>
                                <th data-align="left" data-field="emergencyUnitName" data-visible="false">
                                    紧急联系人单位名称
                                </th>
                                <th data-align="left" data-field="emergencyPhoneNum" data-visible="false">
                                    紧急联系人联系电话
                                </th>
                                <th data-align="left" data-field="emergencyAddress" data-visible="false">
                                    紧急联系人家庭住址
                                </th>

                                <th data-align="left" data-field="colleagueName" data-visible="false">同事姓名</th>
                                <th data-align="left" data-field="colleagueRelation" data-visible="false">同事关系
                                </th>
                                <th data-align="left" data-field="colleagueUnitName" data-visible="false">
                                    同事单位名称
                                </th>
                                <th data-align="left" data-field="colleaguePhoneNum" data-visible="false">
                                    同事联系电话
                                </th>
                                <th data-align="left" data-field="colleagueAddress" data-visible="false">
                                    同事家庭住址
                                </th>
                            </tr>
                            </thead>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Bootstrap Js -->
<script src="assets/js/bootstrap.min.js"></script>
<!-- Metis Menu Js -->
<script src="assets/js/jquery.metisMenu.js"></script>
<!-- Custom Js -->
<script src="assets/js/custom-scripts.js"></script>
<script src="assets/js/select2.full.min.js"></script>
<!-- DATA TABLE SCRIPTS -->
<script src="assets/js/dataTables/jquery.dataTables.js"></script>
<script src="assets/js/dataTables/dataTables.bootstrap.js"></script>
<script src="assets/js/form-validator/form-validator.js"></script>
<!-- Bootstrap Js -->
<script src="assets/js/bootstrap.min.js"></script>
<!-- Metis Menu Js -->
<script src="assets/js/jquery.metisMenu.js"></script>
<!-- Custom Js -->
<script src="assets/js/custom-scripts.js"></script>
<script src="assets/js/select2.full.min.js"></script>
<!-- DATA TABLE SCRIPTS -->
<script src="assets/js/dataTables/jquery.dataTables.js"></script>
<script src="assets/js/dataTables/dataTables.bootstrap.js"></script>

<script type="text/javascript">

    $(function () {
        $('#userinfo-form').bootstrapValidator({
            message: 'This value is not valid',
            feedbackIcons: {
                valid: 'glyphicon glyphicon-ok',
                invalid: 'glyphicon glyphicon-remove',
                validating: 'glyphicon glyphicon-refresh'
            },
            fields: {
                username: {
                    message: '验证失败',
                    validators: {
                        notEmpty: {
                            message: '请填入信息'
                        }
                    }
                },
                useridCard: {
                    message: '验证失败',
                    validators: {
                        notEmpty: {
                            message: '请填入信息'
                        }
                    }
                }
            }
        })
    })

    $('#queryUser').click(function () {
        $('#userinfo-form').bootstrapValidator('validate');
        if ($('#userinfo-form').bootstrapValidator('validate') == false) {
            return;
        }

        var username = $("#username").val().toString();
        var userPhoneNum = $("#userPhoneNum").val().toString();
        var useridCard = $("#useridCard").val().toString();

        $.ajax({
            type: "get",
            url: "clientinfo/getQuery.do",
            data: {
                username: username,
                userPhoneNum: userPhoneNum,
                useridCard: useridCard
            },
            success: function (data) {
                var obj = $.parseJSON(data);
                var state = obj.state;
                if (state == "false") {
                    alert("输入错误");
                } else {
                    var id = obj.id;
                    window.location.href = "UserQuery.html?username=" + username +
                        "&useridCard=" + useridCard;
                }
            }
        });
    });

</script>

<!-- 警告对话框 -->
<div class="modal fade" id="alertdialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header blue">
                <div>
                    <strong id="alertchar" style="font-size:20px"></strong>
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                    <button type="button" id="commitFoodDataButton" class="btn btn-primary">确定</button>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="modal fade" id="loanDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">新增借款办理</div>
            <div class="modal-body">

                <form class="form-horizontal" id="product-form">
                    <div class="row">
                        <div class="form-group">
                            <label class="col-sm-2 control-label">客户名称</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="addName" readonly="readonly"
                                       placeholder="客户名称">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="col-sm-2 control-label">办理产品</label>
                            <div class="col-sm-10">
                                <select class="form-control" id="interest" onchange="select()">
                                </select>

                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">身份证</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="idCard" readonly="readonly"
                                       placeholder="备注信息">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">手机号码</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="phoneNum" readonly="readonly"
                                       placeholder="备注信息">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">客户ID</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="GUID" readonly="readonly"
                                       placeholder="备注信息">
                            </div>
                        </div>

                        <div class="modal-header">
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">产品详情</label>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">金额</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="money" placeholder="借款金额">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">产品周期</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="stage" readonly="readonly">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">每期服务费</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="interes" readonly="readonly"
                                       placeholder="每期服务费">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">期数</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="nper" placeholder="期数">
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">还款类型</label>
                            <div class="col-sm-10">
                                <select class="form-control" id="repayStatus" onchange="select()">
                                    <option>先息后本</option>
                                    <option>等额本息</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="col-sm-2 control-label">产品创建日期</label>
                            <div class="col-sm-10">
                                <input type="text" class="form-control" id="should_repay" readonly="readonly">
                            </div>
                        </div>

                    </div>
                </form>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
                    <button type="button" onclick="commitDataButton();" class="btn btn-primary">添 加</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4 class="modal-title" id="myModalLabel">上传图片</h4>
            </div>
            <div id="preview_box"></div>
            <div class="modal-body">
             <input id="img_input" type="file" accept="image/*"/>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" onclick="upload();" class="btn btn-primary">提交更改</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal -->
</div>

<script src="https://cdn.bootcss.com/vue/2.5.13/vue.js"></script>
<script type="text/javascript">
var uuid;

$("#img_input").on("change", function(e){

	  var file = e.target.files[0]; //获取图片资源

	  var reader = new FileReader();

	  reader.readAsDataURL(file); // 读取文件

	  // 渲染文件
	  reader.onload = function(arg) {

	    var img = '<img class="preview" src="' + arg.target.result + '" alt="preview"/>';
	    $("#preview_box").empty().append(img);
	  }
	});

 function upload(){

	 var fileObj = $("#img_input").prop("files")[0];
	 
     var FileController = "/zc/clientinfo/inputImage.do?uuid=" + uuid; // 接收上传文件的后台地址
     
     if (fileObj){
         // FormData 对象
         var form = new FormData();
         form.append("file", fileObj);// 文件对象
         form.append("uuid", uuid);
         // XMLHttpRequest 对象
         var xhr = new XMLHttpRequest();
         xhr.open("post", FileController, true);
         xhr.onload = function () {

         };
         xhr.send(form);
         xhr.onreadystatechange=function(){
         	 if(xhr.readyState == 4 && xhr.status == 200){    
         	     var b = xhr.responseText;    
         	        if(b == 1){    
         	        	 $("#myModal").modal("hide");
         	          
         	        }else{    
         	        	$("#myModal").modal("hide");
         	            alert("添加图片失败！"); 
         	           
         	        }           
         	    }    
         };
     }
     
 }

  function getcookie(name) {
     var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
     if (arr = document.cookie.match(reg))
         return unescape(arr[2]);
     else
         return null;
  }

    var type = getcookie('type');
    
    if (type == 0) {
    	$('#delete').show();
    } else{
        $('#delete').hide();
    }
    $.post("loan/upOverdueRepayment.do", { //更新逾期状态
    }, function (text) {

    });

    function getcookie(name) {
        var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
        if (arr = document.cookie.match(reg))
            return unescape(arr[2]);
        else
            return null;
    }

    var type = getcookie('type');

    if (type != 0) {
        $("#userhide").hide();
    }

    function select() {
        var objS = document.getElementById("interest");
        var pro_GUID = objS.options[objS.selectedIndex].value;

        $.get("loan/getProduct.do",
            function (text) {
                var json = $.parseJSON(text);
                for (var i = 0; i < json.length; i++) {
                    if (pro_GUID == json[i].pro_GUID) {
                        $("#money").val(json[i].money);
                        $("#stage").val(json[i].stage);
                        $("#interes").val(json[i].interest);
                        $("#nper").val(json[i].nper);
                        $("#cycle").val(json[i].cycle);
                        $("#should_repay").val(json[i].should_repay);
                    }
                }
            });

    }

    function commitDataButton() {
        var username = $('#addName').val().toString();
        var pro_GUID = $('#interest').val().toString();
        var useridCard = $('#idCard').val().toString();
        var userPhoneNum = $('#phoneNum').val().toString();
        var GUID = $('#GUID').val().toString();

        var loanDeal = new Object();

        loanDeal.username = username;
        loanDeal.pro_GUID = pro_GUID;
        loanDeal.useridCard = useridCard;
        loanDeal.userPhoneNum = userPhoneNum;
        loanDeal.GUID = GUID;


        var loanDealData = JSON.stringify(loanDeal);

        $.post("loan/insertLoanDeal.do", {
            loanDealData: loanDealData
        }, function (text) {
            if (text == 1) {
                alert("添加成功");

                var url = "/zc/clientinfo/getAll.do";

                $('#loanDialog').modal("hide");

                $(" #table").bootstrapTable('refresh', {
                    url: url
                });

            } else {
                alert("添加失败");
            }
        });
    }


    function actionStatus(value, row, index) {
        if (value == "0") {
            return "<span>未借款</span>";
        } else if (value == "1") {
            return "<img src='img/right.jpg' width='15px' height='13px' title='已完成'></i><span>已完成</span>";
        } else if (value == "3") {
            return "<img src='img/start.jpg' width='13px' height='13px' title='正常还款'></i><span>正常还款</span>";
        } else if (value > "3") {
            return "<img src='img/wrong.jpg' width='13px' height='13px' title='已逾期'></i><span>已逾期</span>";
        }
    }


    function actionDetail(value, row, index) {
        return [
            '<a  href="javascript:void(0)" onclick="detail(this);" title="点击查看用户详情">',
            value,
            '</a>'].join('');
    }

    function detail(temp) {
        var hang = $(temp.parentNode).parent().prevAll().length + 1;  //jquery获取td所在的行和列
        //var lie = $(temp.parentNode).prevAll().length+1;
        //alert("第"+hang+"行"+"	"+"第"+lie+"列");

        var val = document.getElementById("table").rows[hang].cells[1]; //取得所在列的值
        var id = val.innerHTML;

        window.location.href = "UserDetail.html?id=" + id;
    }

    /*
    function actionReport(value, row, index) {
        return [
            '<a  href="javascript:void(0)" onclick="report(this);" title="点击查看征信报告">',
            '&nbsp;<img src="img/detail.jpg" width="25px" height="25px">&nbsp;',
            '</a>'].join('');
    }
    */

    function actionReport(value, row, index) {
        return [
            // '<a  href="javascript:void(0)" onclick="report(this);" title="点击查看征信报告">',
            // '&nbsp;<img src="img/detail.jpg" width="25px" height="25px">&nbsp;',
            // '</a>&nbsp;',
            '<button type="button" title="点击查看征信报告" onclick="report(this);" class="btn btn-primary">征信报告</button>&nbsp;',
            '<button type="file" title="点击上传图片" onclick="image(this);" class="btn btn-success">上传图片</button>&nbsp;'
        ].join('');
    }


    function report(temp) {
        var hang = $(temp.parentNode).parent().prevAll().length + 1;  //jquery获取td所在的行和列
        //var lie = $(temp.parentNode).prevAll().length+1;
        //alert("第"+hang+"行"+"	"+"第"+lie+"列");

        var val = document.getElementById("table").rows[hang].cells[5]; //取得所在列的值
        var useridCard = val.innerHTML;
        val = document.getElementById("table").rows[hang].cells[3]; //取得所在列的值
        var userName = val.innerHTML;
        val = document.getElementById("table").rows[hang].cells[6]; //取得所在列的值
        var userPhoneNum = val.innerHTML;

        window.location.href = "mobileReportList.html?useridCard=" + useridCard +
            "&userName=" + userName + "&userPhoneNum=" + userPhoneNum;
    }

    
    function image(temp) {
        var hang = $(temp.parentNode).parent().prevAll().length + 1;  //jquery获取td所在的行和列
        //var lie = $(temp.parentNode).prevAll().length+1;
        //alert("第"+hang+"行"+"	"+"第"+lie+"列");

        var val = document.getElementById("table").rows[hang].cells[11]; //取得所在列的值
        
        uuid = val.innerHTML;
        
        $("#myModal").modal("show");
        
    }
    
    function loanModel(temp) {
        var hang = $(temp.parentNode).parent().prevAll().length + 1;
        var username = document.getElementById("table").rows[hang].cells[3].innerHTML;
        var useridCard = document.getElementById("table").rows[hang].cells[5].innerHTML;
        var userPhoneNum = document.getElementById("table").rows[hang].cells[6].innerHTML;

        var obj = document.getElementById("interest");

        var val = document.getElementById("table").rows[hang].cells[12]; //取得所在列的值
        var GUID = val.innerHTML;


        $.get("loan/getProduct.do",
            function (text) {
                obj.options.length = 0;//清楚modal的数据
                var json = $.parseJSON(text);
                for (var i = 0; i < json.length; i++) {

                    var option = document.createElement("option");
                    option.innerHTML = json[i].proName;
                    option.setAttribute("value", json[i].pro_GUID);
                    obj.options.add(option);

                    /*
                    obj.options
                    .add(new Option(
                        json[i].proName,
                        json[i].pro_GUID));
                    */
                }
            });

        $('#loanDialog').modal("show");
        $('#addName').val(username);
        $('#idCard').val(useridCard);
        $('#phoneNum').val(userPhoneNum);
        $('#GUID').val(GUID);
    }

    function repayment(temp) {
        var hang = $(temp.parentNode).parent().prevAll().length + 1;
        var guid = document.getElementById("table").rows[hang].cells[12].innerHTML;
        window.location.href = "allRepayment.html?guid=" + guid;
    }


    $('#plus').click(function () {
        window.location.href = "AddInfo.html";
    });


    $('#edit').on('click', function () {
        var array = $('#table').bootstrapTable('getSelections');
        tag = 1;

        if (array.length > 1) {
            $('#alertchar').text('编辑操作不能同时选中多条记录！');
            $('#commitFoodDataButton').hide();
            $('#alertdialog').modal("show");
        } else if (array.length == 0) {
            $('#alertchar').text('请先选中某条记录！');
            $('#commitFoodDataButton').hide();
            $('#alertdialog').modal("show");
        } else {
            $("#myModalLabel").text("编辑公众号");
            $("#myModal").modal('show');

            window.location.href = "UpdateInfo.html?uuid=" + array[0].guid;
            /*
            var status=document.getElementsByName("status")
            status[1-array[0].status].checked=true;
            */
        }
    });

    
    $('#delete').on('click',function() {
		var array = $('#table').bootstrapTable('getSelections');
		tag=1;

		if (array.length > 1) {
			$('#alertchar').text('删除操作不能同时选中多条记录！');
			$('#commitFoodDataButton').hide();
			$('#alertdialog').modal("show");
		} else if (array.length == 0) {
			$('#alertchar').text('请先选中要删除的记录！');
			$('#commitFoodDataButton').hide();
			$('#alertdialog').modal("show");
		} else {

			var guid=array[0].guid;
			//alert(array[0].userName);
	
	var foodtext='是否确定要删除 '+array[0].userName+' ? ';
	
	$('#alertchar').text(foodtext);
	$('#commitFoodDataButton').show();
	$('#alertdialog').modal("show");
	
	$('#commitFoodDataButton').click(function(){
		//做删除的访问请求
		$.post("clientinfo/delete.do", {
			guid : guid
		}, function(text) {
			var json = $.parseJSON(text);
			if (json == 1) {				
				/*
				for ( var i = array.length - 1; i >= 0; i--) {
					$('#table').bootstrapTable('remove', {
						field : 'foodId',
						values : [ array[i].foodId ]
					});
				   }
					*/
					
					/*
					 * 刷新页面
					 */
					var url="clientinfo/getAll.do";

			    	$(" #table").bootstrapTable('refresh',{
						url : url
					});
			    	
				$('#alertchar').text("删除成功");
				setTimeout(function(){
				 $('#alertdialog').modal("hide");
				},1000);
			 } else if(json==2){
				 $('#alertchar').text("已借款的客户不能删除");
					setTimeout(function(){
						 $('#alertdialog').modal("hide");
					},1000);
			 }else{
				$('#alertchar').text("删除失败");
				setTimeout(function(){
					 $('#alertdialog').modal("hide");
					},1000);
			 }
		  });
	   }); 
	
		}
	});

    function actionTime(value, row, index) {
        var date = new Date(value);
        Y = date.getFullYear() + '-';
        M = (date.getMonth() + 1 < 10 ? '0' + (date.getMonth() + 1) : date.getMonth() + 1) + '-';
        D = date.getDate() + ' ';
        h = date.getHours() + ':';
        m = date.getMinutes() + ':';
        s = date.getSeconds();
        return Y + M + D + h + m + s;
    }

</script>
</body>

</html>